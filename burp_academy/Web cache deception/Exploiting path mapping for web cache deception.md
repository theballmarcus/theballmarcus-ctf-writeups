# Exploiting path mapping for web cache deception
We know that the goal is to get the API key of the victim. I'm guessing that the API key can be found in the `/my-account`.
First, we need to scout for differences in how the url is processed by the cache and the server. If we go to `/my-account` - there is no headers indicating anything about cache. However if we go to `/resources/js/tracking.js` we first get a `X-Cache: miss` - and if we reload, we get a `X-Cache: hit`

Now, we need to look at how we can make the cache store `/my-account` for the victim. I then tried to go to `/my-account/tricked.js` which responded with `X-Cache: miss` and then `X-Cache: hit` the second time. Interesting!

I'n my cache, there is only saved a redirect to `/login` and we need to make a unique identifier for the cache for the victim. We can achieve this by adding url parameters to the request which are unique and will then store the site in the cache where the key depends on the url params. 

That means we can send the victim to `https://0a0c00880380e7f9806c1cc2007d002f.web-security-academy.net/my-account/test.js?t=UNIQUEIDENTIFIER`
and we can visit the site after to retrieve his api key.

The exploit I delivered to the victim was
`<img src=1 onerror="window.location='https://0a0c00880380e7f9806c1cc2007d002f.web-security-academy.net/my-account/test.js?t=4'">` 
I then visited `https://0a0c00880380e7f9806c1cc2007d002f.web-security-academy.net/my-account/test.js?t=4` and could see his API key.